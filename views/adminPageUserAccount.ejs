<%- include("./partials/head.ejs") %>
<link rel="stylesheet" href="/css/adminPageUserAccount.css">
<body>
  <%- include("./partials/nav.ejs") %>
  <section>
    <%- include("./partials/sidebarAdminPage.ejs") %>
    <div class="table-box">
        <div class="table-row table-head">
            <div class="table-cell first-cell">
                <p>Email</p>
            </div>
            <div class="table-cell">
              <p>Ngày tạo tài khoản</p>
          </div>
            <div class="table-cell last-cell">
                <p>Role</p>
            </div>
          
            <div class="table-cell last-cell">
              <p>Xóa tài khoản</p>
          </div> 
        </div>
        
        <% if(users.length>0){ %>
            <% users.forEach(user=> { %>
        <div class="table-row">
            <div class="table-cell first-cell">
                <p><%= user.email %></p>
            </div>
            <div class="table-cell">
              <p><%= user.createdAt %></p>
          </div>
          <div class="table-cell">
            <p><%= user.role %></p>
        </div>
       <div class="table-cell last-cell">
         <a href="/adminPageUserAccountDetails/<%= user._id %>" >Phân Quyền
        </a>
                <a class="trashBin" data-doc="<%= user._id %>" > 
           
                  <img src="/HinhAnh/trash.png" alt="#" >
                </a>
              </div>   
        </div>
        <% }) %>
        <% }else{%>
          <p>Không có tài khoản nào...</p>
          <% } %>
        </div>
      </section>
  

    <script>
  const trashBins = document.querySelectorAll('.trashBin');
  Array.from(trashBins).forEach((trashBin)=>{
    trashBin.addEventListener('click',(e)=>{
      const id = `/adminPageUserAccount/${trashBin.dataset.doc}`;
      fetch(id,{
      method:'DELETE',
    }).then(response => response.json())
    .then(data => window.location.href=data.redirect)
    .catch(err=> console.log(err));
    })
    })

    </script>
</body>
</html>