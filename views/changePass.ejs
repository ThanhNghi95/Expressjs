
<%- include("./partials/head.ejs") %>
<link rel="stylesheet" href="/css/changePass.css">

<body>
   <%- include("./partials/nav.ejs") %>
   <section>
      <%- include("./partials/sidenav.ejs") %>
      <div class="box">
       
         <div class="container">
            <div class="user signupBx">
               <div class="formBx">
                  <form action='/changepass'>
                     <h2>Đổi mật khẩu</h2>
                  
                     <input type="text" name="password" placeholder="Mật khẩu mới" >
                     <input type="text" name="re_password" placeholder="Xác nhận mật khẩu" >
                     <div class="emailError"></div>
                     <input type="submit"  value="Xác nhận">
                     
                  </form>
               </div>
            </div>
         </div>
      </div>
   </section>
   <script>
      const form = document.querySelector('form');
      const passwordError =document.querySelector('.emailError');
      form.addEventListener('submit', async (e)=>{
         e.preventDefault();
         const password = form.password.value;
         const re_password = form.re_password.value;
         if (password!=re_password){
            passwordError.textContent='Mật khẩu không trùng';
         }else{
            try{
               const res = await fetch('/changepass',{
                  method:'POST',
                  body:JSON.stringify( {password:password} ),
                  headers:{'Content-Type':'application/json'}

         });
         const data =await res.json();
         console.log(data)
         if (data.user){
            location.assign('/appointment');
         }
      }catch (err){
         console.log(err);
         }
         }
         
      })
      
   </script>
</body>
</html>